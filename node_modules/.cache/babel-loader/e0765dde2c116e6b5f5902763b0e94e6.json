{"ast":null,"code":"var AWS = require('../core');\n\nvar rest = AWS.Protocol.Rest;\n/**\n * A presigner object can be used to generate presigned urls for the Polly service.\n */\n\nAWS.Polly.Presigner = AWS.util.inherit({\n  /**\n   * Creates a presigner object with a set of configuration options.\n   *\n   * @option options params [map] An optional map of parameters to bind to every\n   *   request sent by this service object.\n   * @option options service [AWS.Polly] An optional pre-configured instance\n   *  of the AWS.Polly service object to use for requests. The object may\n   *  bound parameters used by the presigner.\n   * @see AWS.Polly.constructor\n   */\n  constructor: function Signer(options) {\n    options = options || {};\n    this.options = options;\n    this.service = options.service;\n    this.bindServiceObject(options);\n    this._operations = {};\n  },\n\n  /**\n   * @api private\n   */\n  bindServiceObject: function bindServiceObject(options) {\n    options = options || {};\n\n    if (!this.service) {\n      this.service = new AWS.Polly(options);\n    } else {\n      var config = AWS.util.copy(this.service.config);\n      this.service = new this.service.constructor.__super__(config);\n      this.service.config.params = AWS.util.merge(this.service.config.params || {}, options.params);\n    }\n  },\n\n  /**\n   * @api private\n   */\n  modifyInputMembers: function modifyInputMembers(input) {\n    // make copies of the input so we don't overwrite the api\n    // need to be careful to copy anything we access/modify\n    var modifiedInput = AWS.util.copy(input);\n    modifiedInput.members = AWS.util.copy(input.members);\n    AWS.util.each(input.members, function (name, member) {\n      modifiedInput.members[name] = AWS.util.copy(member); // update location and locationName\n\n      if (!member.location || member.location === 'body') {\n        modifiedInput.members[name].location = 'querystring';\n        modifiedInput.members[name].locationName = name;\n      }\n    });\n    return modifiedInput;\n  },\n\n  /**\n   * @api private\n   */\n  convertPostToGet: function convertPostToGet(req) {\n    // convert method\n    req.httpRequest.method = 'GET';\n    var operation = req.service.api.operations[req.operation]; // get cached operation input first\n\n    var input = this._operations[req.operation];\n\n    if (!input) {\n      // modify the original input\n      this._operations[req.operation] = input = this.modifyInputMembers(operation.input);\n    }\n\n    var uri = rest.generateURI(req.httpRequest.endpoint.path, operation.httpPath, input, req.params);\n    req.httpRequest.path = uri;\n    req.httpRequest.body = ''; // don't need these headers on a GET request\n\n    delete req.httpRequest.headers['Content-Length'];\n    delete req.httpRequest.headers['Content-Type'];\n  },\n\n  /**\n   * @overload getSynthesizeSpeechUrl(params = {}, [expires = 3600], [callback])\n   *   Generate a presigned url for {AWS.Polly.synthesizeSpeech}.\n   *   @note You must ensure that you have static or previously resolved\n   *     credentials if you call this method synchronously (with no callback),\n   *     otherwise it may not properly sign the request. If you cannot guarantee\n   *     this (you are using an asynchronous credential provider, i.e., EC2\n   *     IAM roles), you should always call this method with an asynchronous\n   *     callback.\n   *   @param params [map] parameters to pass to the operation. See the {AWS.Polly.synthesizeSpeech}\n   *     operation for the expected operation parameters.\n   *   @param expires [Integer] (3600) the number of seconds to expire the pre-signed URL operation in.\n   *     Defaults to 1 hour.\n   *   @return [string] if called synchronously (with no callback), returns the signed URL.\n   *   @return [null] nothing is returned if a callback is provided.\n   *   @callback callback function (err, url)\n   *     If a callback is supplied, it is called when a signed URL has been generated.\n   *     @param err [Error] the error object returned from the presigner.\n   *     @param url [String] the signed URL.\n   *   @see AWS.Polly.synthesizeSpeech\n   */\n  getSynthesizeSpeechUrl: function getSynthesizeSpeechUrl(params, expires, callback) {\n    var self = this;\n    var request = this.service.makeRequest('synthesizeSpeech', params); // remove existing build listeners\n\n    request.removeAllListeners('build');\n    request.on('build', function (req) {\n      self.convertPostToGet(req);\n    });\n    return request.presign(expires, callback);\n  }\n});","map":{"version":3,"sources":["/home/ec2-user/chime-voiceconnector-agent-assist/node_modules/aws-sdk/lib/polly/presigner.js"],"names":["AWS","require","rest","Protocol","Rest","Polly","Presigner","util","inherit","constructor","Signer","options","service","bindServiceObject","_operations","config","copy","__super__","params","merge","modifyInputMembers","input","modifiedInput","members","each","name","member","location","locationName","convertPostToGet","req","httpRequest","method","operation","api","operations","uri","generateURI","endpoint","path","httpPath","body","headers","getSynthesizeSpeechUrl","expires","callback","self","request","makeRequest","removeAllListeners","on","presign"],"mappings":"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","sourcesContent":["var AWS = require('../core');\nvar rest = AWS.Protocol.Rest;\n\n/**\n * A presigner object can be used to generate presigned urls for the Polly service.\n */\nAWS.Polly.Presigner = AWS.util.inherit({\n    /**\n     * Creates a presigner object with a set of configuration options.\n     *\n     * @option options params [map] An optional map of parameters to bind to every\n     *   request sent by this service object.\n     * @option options service [AWS.Polly] An optional pre-configured instance\n     *  of the AWS.Polly service object to use for requests. The object may\n     *  bound parameters used by the presigner.\n     * @see AWS.Polly.constructor\n     */\n    constructor: function Signer(options) {\n        options = options || {};\n        this.options = options;\n        this.service = options.service;\n        this.bindServiceObject(options);\n        this._operations = {};\n    },\n\n    /**\n     * @api private\n     */\n    bindServiceObject: function bindServiceObject(options) {\n        options = options || {};\n        if (!this.service) {\n            this.service = new AWS.Polly(options);\n        } else {\n            var config = AWS.util.copy(this.service.config);\n            this.service = new this.service.constructor.__super__(config);\n            this.service.config.params = AWS.util.merge(this.service.config.params || {}, options.params);\n        }\n    },\n\n    /**\n     * @api private\n     */\n    modifyInputMembers: function modifyInputMembers(input) {\n        // make copies of the input so we don't overwrite the api\n        // need to be careful to copy anything we access/modify\n        var modifiedInput = AWS.util.copy(input);\n        modifiedInput.members = AWS.util.copy(input.members);\n        AWS.util.each(input.members, function(name, member) {\n            modifiedInput.members[name] = AWS.util.copy(member);\n            // update location and locationName\n            if (!member.location || member.location === 'body') {\n                modifiedInput.members[name].location = 'querystring';\n                modifiedInput.members[name].locationName = name;\n            }\n        });\n        return modifiedInput;\n    },\n\n    /**\n     * @api private\n     */\n    convertPostToGet: function convertPostToGet(req) {\n        // convert method\n        req.httpRequest.method = 'GET';\n\n        var operation = req.service.api.operations[req.operation];\n        // get cached operation input first\n        var input = this._operations[req.operation];\n        if (!input) {\n            // modify the original input\n            this._operations[req.operation] = input = this.modifyInputMembers(operation.input);\n        }\n\n        var uri = rest.generateURI(req.httpRequest.endpoint.path, operation.httpPath, input, req.params);\n\n        req.httpRequest.path = uri;\n        req.httpRequest.body = '';\n\n        // don't need these headers on a GET request\n        delete req.httpRequest.headers['Content-Length'];\n        delete req.httpRequest.headers['Content-Type'];\n    },\n\n    /**\n     * @overload getSynthesizeSpeechUrl(params = {}, [expires = 3600], [callback])\n     *   Generate a presigned url for {AWS.Polly.synthesizeSpeech}.\n     *   @note You must ensure that you have static or previously resolved\n     *     credentials if you call this method synchronously (with no callback),\n     *     otherwise it may not properly sign the request. If you cannot guarantee\n     *     this (you are using an asynchronous credential provider, i.e., EC2\n     *     IAM roles), you should always call this method with an asynchronous\n     *     callback.\n     *   @param params [map] parameters to pass to the operation. See the {AWS.Polly.synthesizeSpeech}\n     *     operation for the expected operation parameters.\n     *   @param expires [Integer] (3600) the number of seconds to expire the pre-signed URL operation in.\n     *     Defaults to 1 hour.\n     *   @return [string] if called synchronously (with no callback), returns the signed URL.\n     *   @return [null] nothing is returned if a callback is provided.\n     *   @callback callback function (err, url)\n     *     If a callback is supplied, it is called when a signed URL has been generated.\n     *     @param err [Error] the error object returned from the presigner.\n     *     @param url [String] the signed URL.\n     *   @see AWS.Polly.synthesizeSpeech\n     */\n    getSynthesizeSpeechUrl: function getSynthesizeSpeechUrl(params, expires, callback) {\n        var self = this;\n        var request = this.service.makeRequest('synthesizeSpeech', params);\n        // remove existing build listeners\n        request.removeAllListeners('build');\n        request.on('build', function(req) {\n            self.convertPostToGet(req);\n        });\n        return request.presign(expires, callback);\n    }\n});\n"]},"metadata":{},"sourceType":"script"}