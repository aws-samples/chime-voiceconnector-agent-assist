{"ast":null,"code":"/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar _a;\n\nimport * as React from 'react';\nimport { I18n } from '@aws-amplify/core';\nimport { FormField, Input, InputLabel } from '../Amplify-UI/Amplify-UI-Components-React';\nimport { UsernameAttributes } from './common/types';\nimport { PhoneField } from './PhoneField';\nimport { auth } from '../Amplify-UI/data-test-attributes';\nimport AmplifyTheme from '../Amplify-UI/Amplify-UI-Theme';\nvar labelMap = (_a = {}, _a[UsernameAttributes.EMAIL] = 'Email', _a[UsernameAttributes.PHONE_NUMBER] = 'Phone Number', _a[UsernameAttributes.USERNAME] = 'Username', _a);\n\nvar AuthPiece =\n/** @class */\nfunction (_super) {\n  __extends(AuthPiece, _super);\n\n  function AuthPiece(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.inputs = {};\n    _this._isHidden = true;\n    _this._validAuthStates = [];\n    _this.phone_number = '';\n    _this.changeState = _this.changeState.bind(_this);\n    _this.error = _this.error.bind(_this);\n    _this.handleInputChange = _this.handleInputChange.bind(_this);\n    _this.renderUsernameField = _this.renderUsernameField.bind(_this);\n    _this.getUsernameFromInput = _this.getUsernameFromInput.bind(_this);\n    _this.onPhoneNumberChanged = _this.onPhoneNumberChanged.bind(_this);\n    return _this;\n  }\n\n  AuthPiece.prototype.componentDidMount = function () {\n    if (window && window.location && window.location.search) {\n      if (!this.props.authData || !this.props.authData.username) {\n        var searchParams = new URLSearchParams(window.location.search);\n        var username = searchParams ? searchParams.get('username') : undefined;\n        this.setState({\n          username: username\n        });\n      }\n    }\n  };\n\n  AuthPiece.prototype.getUsernameFromInput = function () {\n    var _a = this.props.usernameAttributes,\n        usernameAttributes = _a === void 0 ? 'username' : _a;\n\n    switch (usernameAttributes) {\n      case UsernameAttributes.EMAIL:\n        return this.inputs.email;\n\n      case UsernameAttributes.PHONE_NUMBER:\n        return this.phone_number;\n\n      default:\n        return this.inputs.username || this.state.username;\n    }\n  };\n\n  AuthPiece.prototype.onPhoneNumberChanged = function (phone_number) {\n    this.phone_number = phone_number;\n  };\n\n  AuthPiece.prototype.renderUsernameField = function (theme) {\n    var _a = this.props.usernameAttributes,\n        usernameAttributes = _a === void 0 ? [] : _a;\n\n    if (usernameAttributes === UsernameAttributes.EMAIL) {\n      return React.createElement(FormField, {\n        theme: theme\n      }, React.createElement(InputLabel, {\n        theme: theme\n      }, I18n.get('Email'), \" *\"), React.createElement(Input, {\n        autoFocus: true,\n        placeholder: I18n.get('Enter your email'),\n        theme: theme,\n        key: \"email\",\n        name: \"email\",\n        type: \"email\",\n        onChange: this.handleInputChange,\n        \"data-test\": auth.genericAttrs.emailInput\n      }));\n    } else if (usernameAttributes === UsernameAttributes.PHONE_NUMBER) {\n      return React.createElement(PhoneField, {\n        theme: theme,\n        onChangeText: this.onPhoneNumberChanged\n      });\n    } else {\n      return React.createElement(FormField, {\n        theme: theme\n      }, React.createElement(InputLabel, {\n        theme: theme\n      }, I18n.get(this.getUsernameLabel()), \" *\"), React.createElement(Input, {\n        defaultValue: this.state.username,\n        autoFocus: true,\n        placeholder: I18n.get('Enter your username'),\n        theme: theme,\n        key: \"username\",\n        name: \"username\",\n        onChange: this.handleInputChange,\n        \"data-test\": auth.genericAttrs.usernameInput\n      }));\n    }\n  };\n\n  AuthPiece.prototype.getUsernameLabel = function () {\n    var _a = this.props.usernameAttributes,\n        usernameAttributes = _a === void 0 ? UsernameAttributes.USERNAME : _a;\n    return labelMap[usernameAttributes] || usernameAttributes;\n  }; // extract username from authData\n\n\n  AuthPiece.prototype.usernameFromAuthData = function () {\n    var authData = this.props.authData;\n\n    if (!authData) {\n      return '';\n    }\n\n    var username = '';\n\n    if (typeof authData === 'object') {\n      // user object\n      username = authData.user ? authData.user.username : authData.username;\n    } else {\n      username = authData; // username string\n    }\n\n    return username;\n  };\n\n  AuthPiece.prototype.errorMessage = function (err) {\n    if (typeof err === 'string') {\n      return err;\n    }\n\n    return err.message ? err.message : JSON.stringify(err);\n  };\n\n  AuthPiece.prototype.triggerAuthEvent = function (event) {\n    var state = this.props.authState;\n\n    if (this.props.onAuthEvent) {\n      this.props.onAuthEvent(state, event);\n    }\n  };\n\n  AuthPiece.prototype.changeState = function (state, data) {\n    if (this.props.onStateChange) {\n      this.props.onStateChange(state, data);\n    }\n\n    this.triggerAuthEvent({\n      type: 'stateChange',\n      data: state\n    });\n  };\n\n  AuthPiece.prototype.error = function (err) {\n    this.triggerAuthEvent({\n      type: 'error',\n      data: this.errorMessage(err)\n    });\n  };\n\n  AuthPiece.prototype.handleInputChange = function (evt) {\n    this.inputs = this.inputs || {};\n    var _a = evt.target,\n        name = _a.name,\n        value = _a.value,\n        type = _a.type,\n        checked = _a.checked;\n    var check_type = ['radio', 'checkbox'].includes(type);\n    this.inputs[name] = check_type ? checked : value;\n    this.inputs['checkedValue'] = check_type ? value : null;\n  };\n\n  AuthPiece.prototype.render = function () {\n    if (!this._validAuthStates.includes(this.props.authState)) {\n      this._isHidden = true;\n      this.inputs = {};\n      return null;\n    }\n\n    if (this._isHidden) {\n      this.inputs = {};\n      var track = this.props.track;\n      if (track) track();\n    }\n\n    this._isHidden = false;\n    return this.showComponent(this.props.theme || AmplifyTheme);\n  };\n\n  AuthPiece.prototype.showComponent = function (_theme) {\n    throw 'You must implement showComponent(theme) and don\\'t forget to set this._validAuthStates.';\n  };\n\n  return AuthPiece;\n}(React.Component);\n\nexport default AuthPiece;","map":{"version":3,"sources":["../../src/Auth/AuthPiece.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar _a;\nimport * as React from 'react';\nimport { I18n } from '@aws-amplify/core';\nimport { FormField, Input, InputLabel, } from '../Amplify-UI/Amplify-UI-Components-React';\nimport { UsernameAttributes } from './common/types';\nimport { PhoneField } from './PhoneField';\nimport { auth } from '../Amplify-UI/data-test-attributes';\nimport AmplifyTheme from '../Amplify-UI/Amplify-UI-Theme';\nvar labelMap = (_a = {},\n    _a[UsernameAttributes.EMAIL] = 'Email',\n    _a[UsernameAttributes.PHONE_NUMBER] = 'Phone Number',\n    _a[UsernameAttributes.USERNAME] = 'Username',\n    _a);\nvar AuthPiece = /** @class */ (function (_super) {\n    __extends(AuthPiece, _super);\n    function AuthPiece(props) {\n        var _this = _super.call(this, props) || this;\n        _this.inputs = {};\n        _this._isHidden = true;\n        _this._validAuthStates = [];\n        _this.phone_number = '';\n        _this.changeState = _this.changeState.bind(_this);\n        _this.error = _this.error.bind(_this);\n        _this.handleInputChange = _this.handleInputChange.bind(_this);\n        _this.renderUsernameField = _this.renderUsernameField.bind(_this);\n        _this.getUsernameFromInput = _this.getUsernameFromInput.bind(_this);\n        _this.onPhoneNumberChanged = _this.onPhoneNumberChanged.bind(_this);\n        return _this;\n    }\n    AuthPiece.prototype.componentDidMount = function () {\n        if (window && window.location && window.location.search) {\n            if (!this.props.authData || !this.props.authData.username) {\n                var searchParams = new URLSearchParams(window.location.search);\n                var username = searchParams\n                    ? searchParams.get('username')\n                    : undefined;\n                this.setState({ username: username });\n            }\n        }\n    };\n    AuthPiece.prototype.getUsernameFromInput = function () {\n        var _a = this.props.usernameAttributes, usernameAttributes = _a === void 0 ? 'username' : _a;\n        switch (usernameAttributes) {\n            case UsernameAttributes.EMAIL:\n                return this.inputs.email;\n            case UsernameAttributes.PHONE_NUMBER:\n                return this.phone_number;\n            default:\n                return this.inputs.username || this.state.username;\n        }\n    };\n    AuthPiece.prototype.onPhoneNumberChanged = function (phone_number) {\n        this.phone_number = phone_number;\n    };\n    AuthPiece.prototype.renderUsernameField = function (theme) {\n        var _a = this.props.usernameAttributes, usernameAttributes = _a === void 0 ? [] : _a;\n        if (usernameAttributes === UsernameAttributes.EMAIL) {\n            return (React.createElement(FormField, { theme: theme },\n                React.createElement(InputLabel, { theme: theme },\n                    I18n.get('Email'),\n                    \" *\"),\n                React.createElement(Input, { autoFocus: true, placeholder: I18n.get('Enter your email'), theme: theme, key: \"email\", name: \"email\", type: \"email\", onChange: this.handleInputChange, \"data-test\": auth.genericAttrs.emailInput })));\n        }\n        else if (usernameAttributes === UsernameAttributes.PHONE_NUMBER) {\n            return (React.createElement(PhoneField, { theme: theme, onChangeText: this.onPhoneNumberChanged }));\n        }\n        else {\n            return (React.createElement(FormField, { theme: theme },\n                React.createElement(InputLabel, { theme: theme },\n                    I18n.get(this.getUsernameLabel()),\n                    \" *\"),\n                React.createElement(Input, { defaultValue: this.state.username, autoFocus: true, placeholder: I18n.get('Enter your username'), theme: theme, key: \"username\", name: \"username\", onChange: this.handleInputChange, \"data-test\": auth.genericAttrs.usernameInput })));\n        }\n    };\n    AuthPiece.prototype.getUsernameLabel = function () {\n        var _a = this.props.usernameAttributes, usernameAttributes = _a === void 0 ? UsernameAttributes.USERNAME : _a;\n        return (labelMap[usernameAttributes] || usernameAttributes);\n    };\n    // extract username from authData\n    AuthPiece.prototype.usernameFromAuthData = function () {\n        var authData = this.props.authData;\n        if (!authData) {\n            return '';\n        }\n        var username = '';\n        if (typeof authData === 'object') {\n            // user object\n            username = authData.user ? authData.user.username : authData.username;\n        }\n        else {\n            username = authData; // username string\n        }\n        return username;\n    };\n    AuthPiece.prototype.errorMessage = function (err) {\n        if (typeof err === 'string') {\n            return err;\n        }\n        return err.message ? err.message : JSON.stringify(err);\n    };\n    AuthPiece.prototype.triggerAuthEvent = function (event) {\n        var state = this.props.authState;\n        if (this.props.onAuthEvent) {\n            this.props.onAuthEvent(state, event);\n        }\n    };\n    AuthPiece.prototype.changeState = function (state, data) {\n        if (this.props.onStateChange) {\n            this.props.onStateChange(state, data);\n        }\n        this.triggerAuthEvent({\n            type: 'stateChange',\n            data: state,\n        });\n    };\n    AuthPiece.prototype.error = function (err) {\n        this.triggerAuthEvent({\n            type: 'error',\n            data: this.errorMessage(err),\n        });\n    };\n    AuthPiece.prototype.handleInputChange = function (evt) {\n        this.inputs = this.inputs || {};\n        var _a = evt.target, name = _a.name, value = _a.value, type = _a.type, checked = _a.checked;\n        var check_type = ['radio', 'checkbox'].includes(type);\n        this.inputs[name] = check_type ? checked : value;\n        this.inputs['checkedValue'] = check_type ? value : null;\n    };\n    AuthPiece.prototype.render = function () {\n        if (!this._validAuthStates.includes(this.props.authState)) {\n            this._isHidden = true;\n            this.inputs = {};\n            return null;\n        }\n        if (this._isHidden) {\n            this.inputs = {};\n            var track = this.props.track;\n            if (track)\n                track();\n        }\n        this._isHidden = false;\n        return this.showComponent(this.props.theme || AmplifyTheme);\n    };\n    AuthPiece.prototype.showComponent = function (_theme) {\n        throw 'You must implement showComponent(theme) and don\\'t forget to set this._validAuthStates.';\n    };\n    return AuthPiece;\n}(React.Component));\nexport default AuthPiece;\n//# sourceMappingURL=AuthPiece.js.map"]},"metadata":{},"sourceType":"module"}